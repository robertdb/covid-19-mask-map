(this["webpackJsonpcovid-19-mask-map"]=this["webpackJsonpcovid-19-mask-map"]||[]).push([[0],{124:function(e,t,a){},125:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(29),o=a.n(c),l=(a(90),a(6)),s=Object(n.createContext)({mapObj:null,setMapObj:function(){},maskStores:{},setMaskStores:function(){},centerCoord:null,setCenterCoord:function(){},markerFilter:{plenty:!0,some:!0,few:!0,empty:!1},setMarkerFilter:function(){}});function i(e){var t=e.children,a=Object(n.useState)(null),c=Object(l.a)(a,2),o=c[0],i=c[1],m=Object(n.useState)([]),u=Object(l.a)(m,2),d=u[0],p=u[1],f=Object(n.useState)(null),b=Object(l.a)(f,2),h=b[0],v=b[1],E=Object(n.useState)({plenty:!0,some:!0,few:!0,empty:!1}),g=Object(l.a)(E,2),k=g[0],w=g[1];return r.a.createElement(s.Provider,{value:{mapObj:o,setMapObj:i,maskStores:d,setMaskStores:p,centerCoord:h,setCenterCoord:v,markerFilter:k,setMarkerFilter:w}},t)}function m(){var e=Object(n.useContext)(s);if(void 0===e)throw new Error("useMaskData must be used within a MaskDataContextProvider");return e}var u=a(10),d=a(19),p=a(77),f=a(21),b=a(134),h=a(135),v=a(132),E=a(69),g=a.n(E);a(56);var k=function(){var e=Object(u.b)(),t=e.t,a=e.i18n;return r.a.createElement(b.a,{bg:"light",expand:"lg",className:"mb-3 navbar-mobile-thin"},r.a.createElement(b.a.Brand,{href:"/"},r.a.createElement("img",{src:g.a,width:"24px",alt:"\uacf5\uc801 \ub9c8\uc2a4\ud06c \uc9c0\ub3c4 \ub85c\uace0",className:"mr-2"}),r.a.createElement("a",{class:"title"},t("appName"))),r.a.createElement(b.a.Toggle,{"aria-controls":"basic-navbar-nav"},r.a.createElement("span",null),r.a.createElement("span",null),r.a.createElement("span",null)),r.a.createElement(b.a.Collapse,{id:"basic-navbar-nav"},r.a.createElement(h.a,{className:"ml-auto"},r.a.createElement(v.a,{title:"\ud83c\udf10 Language"},r.a.createElement(v.a.Item,{onClick:function(){return a.changeLanguage("ko")}},"\ud55c\uad6d\uc5b4"),r.a.createElement(v.a.Item,{onClick:function(){return a.changeLanguage("en")}},"English"),r.a.createElement(v.a.Item,{onClick:function(){return a.changeLanguage("zh")}},"\u4e2d\u6587")),r.a.createElement(h.a.Link,{href:"https://livecorona.co.kr"},r.a.createElement(d.a,{icon:f.a,size:"lg"})," ",t("covid19Dashboard")),r.a.createElement(h.a.Link,{href:"https://github.com/LiveCoronaDetector/"},r.a.createElement(d.a,{icon:p.a,size:"lg"})," ",t("github")))))},w=a(9),j=a.n(w),O=a(33),y=a(127),S=a(76),C=a(78),x=a(47),M=a.n(x),_=a(133),F=a(128),L=a(80),N=a(79),I=a.n(N);var D=function(){var e=Object(C.a)(),t=Object(n.useState)(null),a=Object(l.a)(t,2),c=a[0],o=a[1],s=Object(n.useState)(!1),i=Object(l.a)(s,2),p=i[0],b=i[1],h=m(),v=(h.centerCoord,h.setCenterCoord),E=Object(u.b)().t,g=Object(n.useState)(""),k=Object(l.a)(g,2),w=k[0],x=k[1],N=function(){var e=Object(O.a)(j.a.mark((function e(t){var a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,M.a.get("".concat("https://api.livecorona.co.kr","/?address=").concat(t));case 3:return a=e.sent,e.abrupt("return",a);case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0),console.log("Failed to retrieve geocoding for: "+t);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){x(localStorage.getItem("lastSearchedAddress"))}),[]),Object(n.useEffect)((function(){if(e){try{navigator.permissions.query({name:"geolocation"}).then((function(e){o(e.state)}))}catch(a){console.error(a),o("unknown")}if(p&&(null!=e.accuracy||null!=e.latitude||null!=e.longitude)){var t={lat:e.latitude,lng:e.longitude};v(t),console.log(t)}}}),[e,p,v]);var D=function(){var e=Object(O.a)(j.a.mark((function e(){var t,a;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(w.length<1)){e.next=3;break}return alert("\uc8fc\uc18c\ub97c \uc785\ub825\ud574 \uc8fc\uc138\uc694."),e.abrupt("return");case 3:return localStorage.setItem("lastSearchedAddress",w),e.prev=4,e.next=7,N(w);case 7:t=e.sent,e.next=15;break;case 10:return e.prev=10,e.t0=e.catch(4),console.error(e.t0),alert("\uc8fc\uc18c\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \uc2dc\ub3c4\ud574 \uc8fc\uc2ed\uc2dc\uc624."),e.abrupt("return");case 15:if(console.log(t.data),t.data.meta.totalCount){e.next=19;break}return alert("\uc8fc\uc18c\ub97c \ucc3e\uc744 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4. \ub2e4\uc2dc \uc2dc\ub3c4\ud574 \uc8fc\uc2ed\uc2dc\uc624."),e.abrupt("return");case 19:a={lat:t.data.addresses[0].y,lng:t.data.addresses[0].x},v(a);case 21:case"end":return e.stop()}}),e,null,[[4,10]])})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement(y.a,null,r.a.createElement(F.a,null,r.a.createElement(L.a,null,r.a.createElement("div",{className:"text-center mb-5"},r.a.createElement("img",{src:I.a,alt:"\uacf5\uc801 \ub9c8\uc2a4\ud06c \ud310\ub9e4\ucc98",width:"100vw",className:"mb-3"}),r.a.createElement("h1",{class:"title",style:{paddingTop:10}},E("searchMaskStores"))))),r.a.createElement(F.a,{className:"justify-content-center mb-3 text-center"},r.a.createElement(L.a,{sm:12,md:6,lg:5},r.a.createElement(_.a,{onSubmit:function(e){e.preventDefault(),D()}},r.a.createElement(_.a.Group,{controlId:"formBasicEmail"},r.a.createElement(_.a.Label,null,E("addressInputLabel")),r.a.createElement(_.a.Control,{type:"text",placeholder:"",value:w,onChange:function(e){return x(e.target.value)}}),r.a.createElement(_.a.Text,{className:"text-muted"},E("addressInputExample"))),r.a.createElement("div",{className:"d-flex flex-column"},r.a.createElement(S.a,{variant:"primary",className:"mb-2",onClick:D},r.a.createElement(d.a,{icon:f.d})," ",E("searchByAddress")),r.a.createElement(S.a,{variant:"outline-primary",onClick:function(){"granted"!==c&&alert("\uc704\uce58 \uad8c\ud55c\uc744 \ube0c\ub77c\uc6b0\uc800 \uc124\uc815\uc5d0\uc11c \ud5c8\uc6a9\ud574\uc57c \uc0ac\uc6a9\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4"),b(!0)}},r.a.createElement(d.a,{icon:f.c})," ",E("searchByGeoloc"))))))))},z=a(48),B=a(81),T=a(136),A=a(131),P=a(84),G=a(53),W=a.n(G),H=a(129);var J=function(e){var t,a,n=e.remainingStockStr,c=Object(u.b)().t;switch(n){case"plenty":t="success",a=c("badge.plenty");break;case"some":t="warning",a=c("badge.some");break;case"few":t="danger",a=c("badge.few");break;case"empty":t="light",a=c("badge.empty");break;case"break":t="secondary",a=c("badge.break");break;default:t="light",a="?"}return r.a.createElement(H.a,{variant:t},a)},X=function(){var e=Object(n.useState)([]),t=Object(l.a)(e,2),a=t[0],c=t[1],o=Object(n.useState)([]),s=Object(l.a)(o,2),i=s[0],d=s[1],p=Object(n.useState)([]),f=Object(l.a)(p,2),b=f[0],h=f[1],v=Object(n.useState)([]),E=Object(l.a)(v,2),g=E[0],k=E[1],w=Object(n.useState)([]),j=Object(l.a)(w,2),O=j[0],y=j[1],S=Object(n.useState)([]),C=Object(l.a)(S,2),x=C[0],M=C[1],_=Object(u.b)().t,F=m().markerFilter,L=Object(n.useCallback)((function(e,t){if(window.naver||window.naver.maps){var a=[],n=[],c=[],o=[],l=[];t.forEach((function(t){var s,i;if(void 0!==t.remain_stat&&null!==t.remain_stat&&"empty"!==t.remain_stat&&"break"!==t.remain_stat){switch(t.remain_stat){case"plenty":s="green_circle.svg",i="100";break;case"some":s="yellow_circle.svg",i="30";break;case"few":s="red_circle.svg",i="2";break;case"empty":s="gray_circle.svg",i="0";break;case"break":s="gray_circle.svg",i="X";break;default:s="gray_circle.svg",i="X"}var m=new window.naver.maps.Marker({map:e,position:{lat:t.lat,lng:t.lng},icon:{content:'<div class="mask-marker"><img src="./'.concat(s,'" height="30" width="30"></img><p class="marker-text">').concat(i,"</p></div>"),anchor:new window.naver.maps.Point(15,0)}}),u='\n            <div style="font-size: 0.85rem; padding: 5px; width: 200px !important;">\n                <h5 style="font-size: 1rem">'.concat(t.name,'</h5>\n                <p className="mb-0 pb-0">').concat(t.addr,"<br />\n                \ub0a8\uc740 \uc218\ub7c9: ").concat(W.a.renderToString(r.a.createElement(J,{remainingStockStr:t.remain_stat})),' | <a href="https://map.naver.com/v5/search/').concat(t.name,'" target="_blank" rel="noopener noreferrer"\n                >').concat(_("showDirections"),"</a> </p>\n            </div>"),d=new window.naver.maps.InfoWindow({content:u});switch(window.naver.maps.Event.addListener(m,"mouseover",(function(t){d.open(e,m)})),window.naver.maps.Event.addListener(m,"click",(function(t){d.open(e,m)})),t.remain_stat){case"plenty":a.push(m);break;case"some":n.push(m);break;case"few":c.push(m);break;case"empty":o.push(m);break;case"break":l.push(m);break;default:o.push(m)}}})),N(),d(a),h(n),k(c),y(c),M(c)}}),[F]),N=Object(n.useCallback)((function(){a.forEach((function(e){e.setMap(null)})),i.forEach((function(e){e.setMap(null)})),g.forEach((function(e){e.setMap(null)})),b.forEach((function(e){e.setMap(null)})),O.forEach((function(e){e.setMap(null)})),x.forEach((function(e){e.setMap(null)})),c([])}),[a,i,g,b,O,x]);return{addMarker:function(e,t){if(window.naver||window.naver.maps){var a=new window.naver.maps.Marker({map:e,position:{lat:t.lat,lng:t.lng}}),n='\n            <div style="font-size: 0.1rem; padding: 15px;">\n                <h5 style="font-size: 13px">'.concat(t.name,"</h5>\n                <p>").concat(t.addr,"<br />\n                \ub0a8\uc740 \uc218\ub7c9: ").concat(W.a.renderToString(r.a.createElement(J,{remainingStockStr:t.remain_stat})),"</p>\n            </div>"),o=new window.naver.maps.InfoWindow({content:n});window.naver.maps.Event.addListener(a,"mouseover",(function(t){o.open(e,a)})),window.naver.maps.Event.addListener(a,"click",(function(t){o.open(e,a)})),c((function(e){return[].concat(Object(P.a)(e),[a])}))}},addColorIndicatorMarkers:L,resetMarker:N}},Z=function(){return Object(n.useCallback)((function(e,t){if(t={center:{lat:36.377165,lng:127.533382},zoom:1,zoomControl:!0,disableDoubleClickZoom:!0},window.naver&&e.current)return new window.naver.maps.Map(e.current,t)}),[])};var q=function(){var e=m().setMapObj,t=Object(n.useRef)(),a=Z();return Object(n.useEffect)((function(){e(a(t))}),[]),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{id:"map",ref:t,style:{minHeight:"45vh",height:"45vh",maxHeight:"65vh"}}))},R=(a(123),a(130));var V=function(){var e=Object(u.b)().t,t=m().maskStores;return r.a.createElement(r.a.Fragment,null,r.a.createElement(R.a,{responsive:!0},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,e("storeData.name")),r.a.createElement("th",null,e("storeData.stockCount")),r.a.createElement("th",null,e("storeData.address")))),r.a.createElement("tbody",null,t.map((function(e){return r.a.createElement("tr",null,r.a.createElement("td",null,e.name),r.a.createElement("td",null,r.a.createElement(J,{remainingStockStr:e.remain_stat})),r.a.createElement("td",null,e.addr))})))))};var $=function(){var e=Object(u.b)(),t=e.t,a=(e.i18n,m()),c=a.mapObj,o=a.maskStores,s=a.setMaskStores,i=a.centerCoord,p=a.setCenterCoord,b=X(),h=(b.addMarker,b.addColorIndicatorMarkers),v=b.resetMarker,E=Object(n.useState)(!1),g=Object(l.a)(E,2),k=g[0],w=g[1],C=Object(n.useState)(!1),x=Object(l.a)(C,2),_=x[0],N=x[1],I=Object(n.useState)(!0),D=Object(l.a)(I,2),P=D[0],G=D[1],W=Object(n.useState)({plenty:!0,some:!0,few:!0,empty:!1}),H=Object(l.a)(W,2),Z=H[0],R=H[1],$=Object(n.useCallback)((function(e){var t=["plenty","some","few","empty","break",null,void 0];e.sort((function(e,a){return t.indexOf(e.remain_stat)-t.indexOf(a.remain_stat)})),s(e)}),[s]),K=function(e){var t=e.target;console.log(t),R((function(e){return Object(B.a)({},e,Object(z.a)({},t.name,t.checked))}))};return Object(n.useEffect)((function(){console.log(Z)}),[Z]),Object(n.useEffect)((function(){var e=function(){var e=Object(O.a)(j.a.mark((function e(t,a){var n,r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="https://8oi9s0nnth.apigw.ntruss.com/corona19-masks/v1/storesByGeo/json?lat=".concat(t.lat,"&lng=").concat(t.lng,"&m=").concat(a),e.prev=1,w(!0),e.next=5,M()(n);case 5:r=e.sent,w(!1),e.next=15;break;case 9:throw e.prev=9,e.t0=e.catch(1),console.error("An error occurred in fetchStoresByGeo:",e.t0),N(!0),w(!1),Error("Failed");case 15:return e.abrupt("return",r.data.stores);case 16:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t,a){return e.apply(this,arguments)}}();(function(){var t=Object(O.a)(j.a.mark((function t(){var a;return j.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return v(),console.log("Fetching store data..."),t.prev=2,t.next=5,e(i,5e3);case 5:a=t.sent,console.log("New store data fetched"),console.log(a),v(),$(a),t.next=15;break;case 12:t.prev=12,t.t0=t.catch(2),console.error("Failed to fetch data");case 15:case"end":return t.stop()}}),t,null,[[2,12]])})));return function(){return t.apply(this,arguments)}})()()}),[i,$]),Object(n.useEffect)((function(){c&&(c.setCenter(i),c.setZoom(14))}),[c,i]),Object(n.useEffect)((function(){c&&h(c,o)}),[o]),r.a.createElement(r.a.Fragment,null,r.a.createElement("main",null,r.a.createElement(y.a,{id:"mainContainer"},r.a.createElement(F.a,null,r.a.createElement(L.a,{sm:12},P&&r.a.createElement(T.a,{variant:"warning",onClose:function(){return G(!1)},dismissible:!0},r.a.createElement(d.a,{icon:f.b})," ",t("notice.apiIsInBeta")))),r.a.createElement(F.a,null,r.a.createElement(L.a,{md:6},r.a.createElement(q,null),r.a.createElement(S.a,{variant:"outline-primary",className:"mt-1 mb-1",block:!0,onClick:function(){var e=c.getCenter();p({lat:e.y,lng:e.x})}},r.a.createElement(d.a,{icon:f.c})," ",t("refreshMapStores"))),r.a.createElement(L.a,{md:6},_&&r.a.createElement(T.a,{variant:"danger",className:"mt-1"},r.a.createElement(d.a,{icon:f.b})," ",t("error.failedToLoadData")),r.a.createElement("div",{className:"border p-1 mb-1 d-flex flex-row justify-content-between"},r.a.createElement("div",{class:"form-check"},r.a.createElement("input",{type:"checkbox",disabled:!0,class:"form-check-input",id:"showPlentyStores",name:"plenty",defaultChecked:Z.plenty,value:Z.plenty,onChange:K}),r.a.createElement("label",{class:"form-check-label",for:"showPlentyStores"},r.a.createElement(J,{remainingStockStr:"plenty"})," ","100\uac1c +")),r.a.createElement("div",{class:"form-check"},r.a.createElement("input",{type:"checkbox",disabled:!0,class:"form-check-input",id:"showSomeStores",name:"some",defaultChecked:Z.some,value:Z.some,onChange:K}),r.a.createElement("label",{class:"form-check-label",for:"showSomeStores"},r.a.createElement(J,{remainingStockStr:"some"})," ","30-100")),r.a.createElement("div",{class:"form-check"},r.a.createElement("input",{type:"checkbox",disabled:!0,class:"form-check-input",id:"showFewStores",name:"few",defaultChecked:Z.few,value:Z.few,onChange:K}),r.a.createElement("label",{class:"form-check-label",for:"showFewStores"},r.a.createElement(J,{remainingStockStr:"few"})," ","2-30")),r.a.createElement("div",{class:"form-check"},r.a.createElement("input",{type:"checkbox",disabled:!0,class:"form-check-input",id:"showEmptyStores",name:"empty",defaultChecked:Z.empty,value:Z.empty,onChange:K}),r.a.createElement("label",{class:"form-check-label",for:"showEmptyStores"},r.a.createElement(J,{remainingStockStr:"empty"})," ","0\uac1c"))),k?r.a.createElement(A.a,{animation:"border",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")):o&&o.length?r.a.createElement(r.a.Fragment,null,r.a.createElement(V,{style:{overflow:"auto",maxHeight:"100px"}})):r.a.createElement(T.a,{variant:"danger"},"\uc8fc\ubcc0\uc5d0 \ub9c8\uc2a4\ud06c \ud310\ub9e4\ucc98\uac00 \uc5c6\uc2b5\ub2c8\ub2e4. \uc9c0\ub3c4\ub97c \uc774\ub3d9\ud55c \ud6c4 \uc9c0\ub3c4 \uc544\ub798\uc758 \uc7ac\uac80\uc0c9 \ubc84\ud2bc\uc744 \uc774\uc6a9\ud574 \uc8fc\uc138\uc694."))))))};var K=function(){var e=m(),t=e.centerCoord;return e.setCenterCoord,r.a.createElement(r.a.Fragment,null,t?r.a.createElement($,null):r.a.createElement(D,null))};a(124);var Q=function(){return r.a.createElement(n.Suspense,{fallback:r.a.createElement("div",null)},r.a.createElement(i,null,r.a.createElement("header",{className:"App-header"},r.a.createElement(k,null)),r.a.createElement(K,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var U=a(54),Y=a(82),ee=a(83);U.a.use(Y.a).use(ee.a).use(u.a).init({fallbackLng:"ko",debug:!1,interpolation:{escapeValue:!1}});U.a;o.a.render(r.a.createElement(Q,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},56:function(e,t,a){},69:function(e,t,a){e.exports=a.p+"static/media/MaskMapLogo.b988c109.svg"},79:function(e,t,a){e.exports=a.p+"static/media/MaskMapIntro.146663f2.svg"},85:function(e,t,a){e.exports=a(125)},90:function(e,t,a){}},[[85,1,2]]]);
//# sourceMappingURL=main.05ea812d.chunk.js.map